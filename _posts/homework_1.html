<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.0.36">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jingjing Liang">

<title>Homework 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="homework_1_files/libs/clipboard/clipboard.min.js"></script>
<script src="homework_1_files/libs/quarto-html/quarto.js"></script>
<script src="homework_1_files/libs/quarto-html/popper.min.js"></script>
<script src="homework_1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="homework_1_files/libs/quarto-html/anchor.min.js"></script>
<link href="homework_1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="homework_1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="homework_1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="homework_1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="homework_1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article toc-left">
<div id="quarto-sidebar-toc-left" class="sidebar toc-left">
  <nav id="TOC" role="doc-toc">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#bronze" id="toc-bronze" class="nav-link active" data-scroll-target="#bronze">Bronze</a>
  <ul class="collapse">
  <li><a href="#question-1-production-cost-minimization" id="toc-question-1-production-cost-minimization" class="nav-link" data-scroll-target="#question-1-production-cost-minimization">Question 1: Production Cost Minimization</a></li>
  <li><a href="#question-2-convenience-store-diet" id="toc-question-2-convenience-store-diet" class="nav-link" data-scroll-target="#question-2-convenience-store-diet">Question 2: Convenience Store Diet</a></li>
  <li><a href="#question-3-steel-mill-emissions" id="toc-question-3-steel-mill-emissions" class="nav-link" data-scroll-target="#question-3-steel-mill-emissions">Question 3: Steel Mill Emissions</a></li>
  </ul></li>
  <li><a href="#silver" id="toc-silver" class="nav-link" data-scroll-target="#silver">Silver</a></li>
  </ul>
</nav>
</div>
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Homework 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Jingjing Liang </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="bronze" class="level2">
<h2 class="anchored" data-anchor-id="bronze">Bronze</h2>
<section id="question-1-production-cost-minimization" class="level3">
<h3 class="anchored" data-anchor-id="question-1-production-cost-minimization">Question 1: Production Cost Minimization</h3>
<p>Code the following model so that you minimize production and storage costs over a 4 month period:</p>
<p><span class="math display">\[
Min: \sum\limits_{i=1}^4 (12m_i + 2s_i) \\
m1 - s1 = 100 \\
s1 + m2 - s2 = 200 \\
s2 + m3 - s3 = 150 \\
s3 + m4 - s4 = 400 \\
m1 \leq 400 \\
m2 \leq 400 \\
m3 \leq 300 \\
m4 \leq 300
\]</span></p>
<p>What is the total cost for this problem? Provide a very brief explanation of the first 4 constraints.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>c_vector1 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">2</span>),<span class="at">times=</span><span class="dv">4</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>b_vector1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">150</span>,<span class="dv">400</span>,<span class="dv">400</span>,<span class="dv">400</span>,<span class="dv">300</span>,<span class="dv">300</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>A_mat1 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>con_dir1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&gt;="</span>,<span class="st">"&gt;="</span>,<span class="st">"&gt;="</span>,<span class="st">"&gt;="</span>,<span class="st">"&lt;="</span>,<span class="st">"&lt;="</span>,<span class="st">"&lt;="</span>,<span class="st">"&lt;="</span>)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>product_1 <span class="ot">&lt;-</span> linprog<span class="sc">::</span><span class="fu">solveLP</span>(<span class="at">cvec =</span> c_vector1 , </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bvec=</span> b_vector1 ,</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Amat =</span> A_mat1, </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maximum =</span> <span class="cn">FALSE</span>,</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">const.dir =</span> con_dir1)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>cost1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(c_vector1 <span class="sc">*</span> product_1<span class="sc">$</span>solution)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Answer: The total cost of is 10,400. The first 4 constraints represents the inventory from last month adding the production of this month and substracting the intentory of this month equal to a constant, so it means sales of that month.</p>
</section>
<section id="question-2-convenience-store-diet" class="level3">
<h3 class="anchored" data-anchor-id="question-2-convenience-store-diet">Question 2: Convenience Store Diet</h3>
<p>The average resident of Paris, Illinois needs to consume at least 2000 calories a day from the nearest convenience store; naturally, it needs to be done as cheaply as possible and a healthy diet typically consists of at least 10 ounces of sugar. A slice of pizza costs 3 dollars, coffee is 1 dollar, Red Bull is usually on sale for 1.50 per can, and candy bars cost 1 dollar.</p>
<p>A slice of pizza contains 285 calories and practically 0 sugar.</p>
<p>A cup of sweet coffee contains 1/2 oz of sugar and 100 calories.</p>
<p>A can of Red Bull contains 168 calories and 2 oz of sugar.</p>
<p>A candy bar contains about 200 calories and 3 oz of sugar.</p>
<p>What is the total cost to consume the proper amount of food and how much of each food should be bought?</p>
<p>$$ Min: 3Pizza+1Coffee+1.5Red+1Candy\ Calories: 285Pizza + 100Coffee + 168Red + 200Candy \ Sugar: .5Coffee+2Red+3Candy \</p>
<p>$$</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>c_vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>b_vector2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">2000</span>,<span class="dv">10</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>A_mat2 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">285</span>, <span class="dv">100</span>, <span class="dv">168</span>, <span class="dv">200</span>),</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>con_dir2 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&gt;="</span>, <span class="st">"&gt;="</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>product_2 <span class="ot">&lt;-</span> linprog<span class="sc">::</span><span class="fu">solveLP</span>(<span class="at">cvec =</span> c_vector2 , </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bvec=</span> b_vector2 ,</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Amat =</span> A_mat2, </span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maximum =</span> <span class="cn">FALSE</span>,</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">const.dir =</span> con_dir2)</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>product_2<span class="sc">$</span>solution</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> 1  2  3  4 
 0  0  0 10 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cost2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(c_vector2<span class="sc">*</span>product_2<span class="sc">$</span>solution)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>cost2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Sounds like an awful diet...</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Answer: The lowest total cost is 10 dollars for buying 10 candy bars.</p>
</section>
<section id="question-3-steel-mill-emissions" class="level3">
<h3 class="anchored" data-anchor-id="question-3-steel-mill-emissions">Question 3: Steel Mill Emissions</h3>
<p>A steel mill is trying to reduce emissions of three particular kinds of air pollutants.</p>
<p>The following are clean air standards for the facility (in millions of pounds):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">pollutant =</span> <span class="fu">c</span>(<span class="st">"particulates"</span>, <span class="st">"sulfer oxides"</span>, <span class="st">"hydrocarbons"</span>), </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">requiredReduction =</span> <span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">150</span>, <span class="dv">125</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      pollutant requiredReduction
1  particulates                60
2 sulfer oxides               150
3  hydrocarbons               125</code></pre>
</div>
</div>
<p>The steel mill has two major sources of these pollutants: blast furnaces and open-hearth furnances. To reduce the pollutants from these two furnace types, engineers are exploring using taller smokestacks, filters, and cleaner fuels.</p>
<p>The following are maximum estimated reduction rates (in millions of pounds) for various abatement methods:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">pollutant =</span> <span class="fu">c</span>(<span class="st">"particulates"</span>, <span class="st">"sulfer oxides"</span>, <span class="st">"hydrocarbons"</span>), </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">ts_blastFurnace =</span> <span class="fu">c</span>(<span class="dv">12</span>, <span class="dv">35</span>, <span class="dv">37</span>), </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">ts_openHearth =</span> <span class="fu">c</span>(<span class="dv">9</span>, <span class="dv">42</span>, <span class="dv">53</span>), </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">filter_blastFurnace =</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">18</span>, <span class="dv">28</span>), </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">filter_openHearth =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">31</span>, <span class="dv">24</span>), </span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">fuels_blastFurnace =</span> <span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">56</span>, <span class="dv">29</span>), </span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">fuels_openHearth =</span> <span class="fu">c</span>(<span class="dv">13</span>, <span class="dv">49</span>, <span class="dv">20</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      pollutant ts_blastFurnace ts_openHearth filter_blastFurnace
1  particulates              12             9                  25
2 sulfer oxides              35            42                  18
3  hydrocarbons              37            53                  28
  filter_openHearth fuels_blastFurnace fuels_openHearth
1                20                 17               13
2                31                 56               49
3                24                 29               20</code></pre>
</div>
</div>
<p>Each of these abatement methods can be used to any proportion.</p>
<p>The following table specifies the cost for fully-adopting each method (if the proportion is 1):</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">method =</span> <span class="fu">c</span>(<span class="st">"taller smokestacks"</span>, <span class="st">"filters"</span>, <span class="st">"fuels"</span>), </span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">blastFurnaces =</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">7</span>, <span class="dv">11</span>), </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">openHearth =</span> <span class="fu">c</span>(<span class="dv">10</span>, <span class="dv">6</span>, <span class="dv">9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>              method blastFurnaces openHearth
1 taller smokestacks             8         10
2            filters             7          6
3              fuels            11          9</code></pre>
</div>
</div>
<p>The ultimate goal of the steel mill is to minimize the money spent on each abatement method, while hitting the require reduction thresholds.</p>
<p>This creates the following linear program:</p>
<p><span class="math display">\[Minimize Z = 8_{x1} + 10_{x2} +7_{x3} +6_{x4} + 11_{x5} + 9_{x6}\]</span></p>
<p><strong>Subject to the following emission reduction constrains:</strong></p>
<p><span class="math display">\[12_{x1} + 9_{x2} + 25_{x3} + 20_{x4} + 17_{x5} + 13_{x6} \geq 60 \\
35_{x1} + 42_{x2} + 18_{x3} + 31_{x4} + 56_{x5} + 49_{x6} \geq 150 \\
37_{x1} + 53_{x2} + 28_{x3} + 24_{x4} + 29_{x5} + 20_{x6} \geq 125
\]</span></p>
<p><strong>Subject to the following technology limitation constrains:</strong></p>
<p><span class="math display">\[x_j \leq 1\]</span></p>
<p>What is each abatement methods optimal proportion?</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>c_vector3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">7</span>, <span class="dv">6</span>, <span class="dv">11</span>, <span class="dv">9</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>b_vector3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">60</span>,<span class="dv">150</span>,<span class="dv">125</span>,<span class="fu">rep</span>(<span class="dv">1</span>,<span class="at">times=</span><span class="dv">6</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>A_mat3 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">12</span>,<span class="dv">9</span>,<span class="dv">25</span>,<span class="dv">20</span>,<span class="dv">17</span>,<span class="dv">13</span>),</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">35</span>,<span class="dv">42</span>,<span class="dv">18</span>,<span class="dv">31</span>,<span class="dv">56</span>,<span class="dv">49</span>),</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">37</span>,<span class="dv">53</span>,<span class="dv">28</span>,<span class="dv">24</span>,<span class="dv">29</span>,<span class="dv">20</span>),</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">diag</span>(<span class="dv">6</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>con_dir3 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&gt;="</span>, <span class="st">"&gt;="</span>, <span class="st">"&gt;="</span>, <span class="fu">rep</span>(<span class="st">"&lt;="</span>,<span class="dv">6</span>))</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>product_3 <span class="ot">&lt;-</span> linprog<span class="sc">::</span><span class="fu">solveLP</span>(<span class="at">cvec =</span> c_vector3 , </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bvec=</span> b_vector3 ,</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Amat =</span> A_mat3, </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maximum =</span> <span class="cn">FALSE</span>,</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">const.dir =</span> con_dir3)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>product_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Results of Linear Programming / Linear Optimization

Objective function (Minimum): 32.1546 

Iterations in phase 1: 6
Iterations in phase 2: 2
Solution
        opt
1 1.0000000
2 0.6226975
3 0.3434794
4 1.0000000
5 0.0475728
6 1.0000000

Basic Variables
          opt
1   1.0000000
2   0.6226975
3   0.3434794
4   1.0000000
5   0.0475728
6   1.0000000
S 5 0.3773025
S 6 0.6565206
S 8 0.9524272

Constraints
       actual dir bvec     free      dual  dual.reg
1  60.0000000  &gt;=   60 0.000000 0.1110470 14.297143
2 150.0000000  &gt;=  150 0.000000 0.1268171 20.453125
3 125.0000000  &gt;=  125 0.000000 0.0693256  2.041667
4   1.0000000  &lt;=    1 0.000000 0.3362110  0.748477
5   0.6226975  &lt;=    1 0.377303 0.0000000  0.377303
6   0.3434794  &lt;=    1 0.656521 0.0000000  0.656521
7   1.0000000  &lt;=    1 0.000000 1.8160850  1.000000
8   0.0475728  &lt;=    1 0.952427 0.0000000  0.952427
9   1.0000000  &lt;=    1 0.000000 0.0441616  0.962709

All Variables (including slack variables)
          opt cvec       min.c      max.c      marg  marg.reg
1   1.0000000    8          NA  8.3362110        NA        NA
2   0.6226975   10 -10.6669616 10.4294463        NA        NA
3   0.3434794    7  -9.0114600  7.3816327        NA        NA
4   1.0000000    6          NA  7.8160850        NA        NA
5   0.0475728   11 -11.0446384 13.9752252        NA        NA
6   1.0000000    9          NA  9.0441616        NA        NA
S 1 0.0000000    0  -0.1110470        Inf 0.1110470 14.297143
S 2 0.0000000    0  -0.1268171        Inf 0.1268171 20.453125
S 3 0.0000000    0  -0.0693256        Inf 0.0693256  2.041667
S 4 0.0000000    0  -0.3362110        Inf 0.3362110  0.748477
S 5 0.3773025    0  -0.4294463  0.6669616 0.0000000        NA
S 6 0.6565206    0  -0.3816327  2.0114600 0.0000000        NA
S 7 0.0000000    0  -1.8160850        Inf 1.8160850  1.000000
S 8 0.9524272    0  -2.9752252  0.0446384 0.0000000        NA
S 9 0.0000000    0  -0.0441616        Inf 0.0441616  0.962709</code></pre>
</div>
</div>
<p>On blast furnaces, the results suggest applying 1 taller smoke, 0.34 filters and 0.04 cleaner fuels</p>
<p>On open hearth, the results suggest applying 0.62 taller smoke, 1 filters and 1 cleaner fuels.</p>
<p>the proportion is then (1+0.62):(0.34+1):(0.04+1), which is 0.405:0.335:0.26</p>
</section>
</section>
<section id="silver" class="level2">
<h2 class="anchored" data-anchor-id="silver">Silver</h2>
<p>Let’s extend that question 1 just a little bit more.</p>
<p>The cost of labor over the next four months will go up by 3 dollars a month, starting at 12 dollars. Every unit that gets made needs to go into storage and it requires 2 dollars to store each unit. Every unit made requires 30 minutes of labor. Fortunately, exact demand and available labor are known months in advance and are as follows: demand = 100, 200, 150, 400; max labor hours = 200, 200, 150, 150. Anything made during a month can be stored and reused the following month. Add the increased labor costs and resources to your model, and then report the production plan.</p>
<p><span class="math display">\[
Min: \sum\limits_{i=1}^4 (7.5m_i + 2s_i) \\
m1 - s1 \geq 100 \\
s1 + m2 - s2 \geq 200 \\
s2 + m3 - s3 \geq 150 \\
s3 + m4 - s4 \geq 400 \\
m1 \leq 400 \\
m2 \leq 400 \\
m3 \leq 300 \\
m4 \leq 300
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>c_vector4 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">7.5</span>,<span class="dv">2</span>),<span class="at">times=</span><span class="dv">4</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>b_vector4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">150</span>,<span class="dv">400</span>,<span class="dv">400</span>,<span class="dv">400</span>,<span class="dv">300</span>,<span class="dv">300</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>A_mat4 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="sc">-</span><span class="dv">1</span>),</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>),</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>))</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>con_dir4 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&gt;="</span>,<span class="st">"&gt;="</span>,<span class="st">"&gt;="</span>,<span class="st">"&gt;="</span>,<span class="st">"&lt;="</span>,<span class="st">"&lt;="</span>,<span class="st">"&lt;="</span>,<span class="st">"&lt;="</span>)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>product_4 <span class="ot">&lt;-</span> linprog<span class="sc">::</span><span class="fu">solveLP</span>(<span class="at">cvec =</span> c_vector4 , </span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bvec=</span> b_vector4 ,</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Amat =</span> A_mat4, </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maximum =</span> <span class="cn">FALSE</span>,</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>                 <span class="at">const.dir =</span> con_dir4)</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>product_4</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Results of Linear Programming / Linear Optimization

Objective function (Minimum): 6575 

Iterations in phase 1: 6
Iterations in phase 2: 2
Solution
  opt
1 100
2   0
3 200
4   0
5 250
6 100
7 300
8   0

Basic Variables
    opt
1   100
3   200
5   250
6   100
7   300
S 5 300
S 6 200
S 7  50

Constraints
  actual dir bvec free dual dual.reg
1    100  &gt;=  100    0  7.5      300
2    200  &gt;=  200    0  7.5      200
3    150  &gt;=  150    0  7.5       50
4    400  &gt;=  400    0  9.5       50
5    100  &lt;=  400  300  0.0      300
6    200  &lt;=  400  200  0.0      200
7    250  &lt;=  300   50  0.0       50
8    300  &lt;=  300    0  2.0       50

All Variables (including slack variables)
    opt cvec min.c max.c marg marg.reg
1   100  7.5  -9.5   Inf   NA       NA
2     0  2.0  99.0  77.0  2.0      200
3   200  7.5  -9.5   9.5   NA       NA
4     0  2.0  99.0  77.0  2.0      200
5   250  7.5  -9.5   9.5   NA       NA
6   100  2.0  -4.0   Inf   NA       NA
7   300  7.5    NA   9.5   NA       NA
8     0  2.0  99.0  77.0 11.5       50
S 1   0  0.0  -7.5   Inf  7.5      300
S 2   0  0.0  -7.5   Inf  7.5      200
S 3   0  0.0  -7.5   Inf  7.5       50
S 4   0  0.0  -9.5   Inf  9.5       50
S 5 300  0.0    NA   2.0  0.0       NA
S 6 200  0.0  -2.0   2.0  0.0       NA
S 7  50  0.0  -2.0   2.0  0.0       NA
S 8   0  0.0  -2.0   Inf  2.0       50</code></pre>
</div>
</div>
<p>Answer: The production plan would be: produce 100,200,250,300 for the first four months, respectively. ## Gold</p>
<p>The hardest of all questions – put down your Google and create your own linear optimization problem! It can be a minimization or maximization problem. You need at least 3 variables and at least 3 constraints. Explain the set-up, write the notation, code it up, and then tell me what you found! Seriously, no need to involve Google in this – come up with something on your own.</p>
<p>//I have to minimize my groceries cost while finish the groceries I bought last week, otherwise they will rot in my fridge (especially fresh vegetables). I’m wondering how I can optimize the proportion of money I put into each category</p>
<p>Meat x1 Fresh vegetables x2 Storage vegetables x3</p>
<p>10% of the meat, 80% of the fresh vegetables and 30% of the storage vegetables perishes at the end of the week</p>
<p>average price of meat, fresh vegetables and storage vegetables are $17, $10 and $3</p>
<p>I want to minimize the cost of perished groceries:</p>
<p>Min: 0.1<em>17X1 + 0.8</em>10x2 + 0.3*3x3</p>
<p>Meat provides 117gram of protein, 9000IU vitamin; Fresh vegetables provides 5gram of protein, and 19400IU vitamin; Storage provides 3gram of protein and 15000IU vitamin.</p>
<p>To meet my protein demand: 117x1 + 5x2 + 3x3 &gt;= 350 To meet the vitamin demand: 9000x1 + 19400x2 + 16000x3 &gt;= 50000</p>
<p>My refrigerator has limited capacity: x1 + x2 + x3 &lt;= 30</p>
<p>I want at least 3 pound of meat: x1 &gt;= 3</p>
<p><span class="math display">\[
Min: 1.7x1 + 8x2 + 0.9x3 \\
St:117x1 + 5x2 + 3x3 \geq 350 \\
9000x1 + 19400x2+16000x3 \geq 50000 \\
x1+x2+x3 \leq 30 \\
x1 \geq 3
\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>c_vector5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">1.7</span>,<span class="dv">8</span>,<span class="fl">0.9</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>b_vector5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">400</span>,<span class="dv">500000</span>,<span class="dv">30</span>,<span class="dv">3</span>)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>A_mat5 <span class="ot">&lt;-</span> <span class="fu">rbind</span>(<span class="fu">c</span>(<span class="dv">117</span>,<span class="dv">5</span>,<span class="dv">3</span>),</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">9000</span>,<span class="dv">19400</span>,<span class="dv">16000</span>),</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>),</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>                <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>con_dir5 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"&gt;="</span>,<span class="st">"&gt;="</span>,<span class="st">"&lt;="</span>,<span class="st">"&gt;="</span>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>product_5 <span class="ot">&lt;-</span> linprog<span class="sc">::</span><span class="fu">solveLP</span>(<span class="at">cvec =</span> c_vector5 , </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>                 <span class="at">bvec=</span> b_vector5 ,</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>                 <span class="at">Amat =</span> A_mat5, </span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>                 <span class="at">maximum =</span> <span class="cn">FALSE</span>,</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a>                 <span class="at">const.dir =</span> con_dir5)</span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>product_5</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>

Results of Linear Programming / Linear Optimization

Objective function (Minimum): 115.018 

Iterations in phase 1: 3
Iterations in phase 2: 1
Solution
      opt
1  3.0000
2 12.0588
3 14.9412

Basic Variables
        opt
1    3.0000
2   12.0588
3   14.9412
S 1 56.1176

Constraints
      actual dir  bvec    free        dual    dual.reg
1    456.118  &gt;= 4e+02 56.1176  0.00000000    56.11765
2 500000.000  &gt;= 5e+05  0.0000  0.00208824 50800.00000
3     30.000  &lt;= 3e+01  0.0000 32.51176471     2.61856
4      3.000  &gt;= 3e+00  0.0000 15.41764706     4.88462

All Variables (including slack variables)
        opt cvec        min.c   max.c        marg    marg.reg
1    3.0000  1.7 -17.11764706     Inf          NA          NA
2   12.0588  8.0 -14.90875000      NA          NA          NA
3   14.9412  0.9           NA 5.94038          NA          NA
S 1 56.1176  0.0  -0.13052789      NA  0.00000000          NA
S 2  0.0000  0.0  -0.00208823     Inf  0.00208823 50800.00000
S 3  0.0000  0.0 -32.51176471     Inf 32.51176471     2.61856
S 4  0.0000  0.0 -15.41764706     Inf 15.41764706     4.88462</code></pre>
</div>
</div>
<p>I should buy 3 pound of meat, 12 pound of fresh vegetables and 15 pound of storage vegetables each week.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      let href = ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>